<html>
	<head>
		<title>IERGS - Seminario V</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
			<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
			<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />

			<script src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>
			<script src="https://cdn.datatables.net/1.10.12/js/dataTables.bootstrap.min.js"></script>  

			<link rel="stylesheet" href="https://cdn.datatables.net/1.10.12/css/dataTables.bootstrap.min.css" />

			<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
			<link rel="stylesheet" href="css/styles.css" />
		</head>
		<body>
			<div class="container box">
				<nav class="navbar navbar-default">
					<div class="container-fluid">
						<div class="navbar-header"><a class="navbar-brand" href="#">IERGS SEMINÁRIO V</a></div>
						<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
							<ul class="nav navbar-nav">
								<li><a onclick="loadEditoras()" href="#editoras">Editoras</a></li>
								<li><a href="#">Livros</a></li>
								<li><a href="#">Empréstimos</a></li>
								<li><a href="#">Usuários</a></li>
							</ul>
						</div><!-- /.navbar-collapse -->
					</div><!-- /.container-fluid -->
				</nav><!-- /.navbar -->

				<!-- Data Table Editoras -->
				<div class="table-responsive">
					<br />
					<div align="right">
						<button type="button" id="add_button" data-toggle="modal" data-target="#editora_modal" class="btn btn-info btn-lg">Novo</button>
					</div>
					<br /><br />
					<table id="editoras_data" class="table table-bordered table-striped">
						<thead>
							<tr>
								<th width="80%">Editora</th>
								<th width="10%">Editar</th>
								<th width="10%">Excluir</th>
							</tr>
						</thead>
					</table>
				</div>
				
				<div id="editora_modal" class="modal fade">
					<div class="modal-dialog">
						<form method="post" id="editora_form" enctype="multipart/form-data">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal">&times;</button>
									<h4 class="modal-title">Adicionar Editora</h4>
								</div>
								<div class="modal-body">
									<label>Nome</label>
									<input type="text" name="editora_nome" id="editora_nome" class="form-control" />
									<br />
								</div>
								<div class="modal-footer">
									<input type="hidden" name="editora_id" id="editora_id" />
									<input type="hidden" name="operation" id="operation" />
									<input type="submit" name="action" id="action" class="btn btn-success" value="Salvar" />
									<button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
								</div>
							</div>
						</form>
					</div>
				</div>
				<!-- Editoras Data Table End -->

			</div><!-- end container box -->
		</body>
	</html>

	

	<script type="text/javascript" language="javascript" >

//Carrega as Editoras
var loadEditoras = function() {
	var dataSet = [];
	var restAPI = "api/Editoras";
	$.getJSON( restAPI )
	.done(function( data ) {
		$.each( data, function( i, result ) {
			var newArray = [];
			newArray.push(result.nome);
			newArray.push('<button type="button" name="update" id="' + result.id + '" class="btn btn-warning btn-xs update">Editar</button>');
			newArray.push('<button type="button" name="delete" id="' + result.id + '" class="btn btn-danger btn-xs delete">Excluir</button>');
			dataSet.push(newArray);
		});
		$('#editoras_data').DataTable({
			"data": dataSet
		});
	});
}

//Jquery Ready
$(document).ready(function(){

	//New Button
	$('#add_button').click(function(){
		$('#editora_form')[0].reset();
		$('.modal-title').text("Nova Editora");
		$('#action').val("Add");
		$('#operation').val("Add");
		$('#user_uploaded_image').html('');
	});

	//Edit Button
	$(document).on('click', '.update', function(){
		$.ajax({
			url:'api/Editoras/' + $(this).attr("id"),
			method:"GET",
			dataType:"json",
			success:function(data)
			{
				$('#editora_modal').modal('show');
				$('#editora_nome').val(data.nome);
				$('.modal-title').text("Alterar Editora");
				$('#editora_id').val(editora_id);
				$('#action').val("Edit");
				$('#operation').val("Edit");
			}
		})
	});

	//Delete Button **implementar
	$(document).on('click', '.delete', function(){
		var id = $(this).attr("id");
		if(confirm("Confirma a exclusão?"))
		{
			alert("Excluído!")
		}
		else
		{
			return false; 
		}
	});

	//Edit Save **implementar

	//Novo Save **implementar

});
	</script>